<section class="space-y-6">
  <header class="flex items-center justify-between gap-4">
    <h1 class="text-2xl font-semibold text-slate-900">Users</h1>

    <button
      mat-icon-button
      type="button"
      class="border border-slate-200 bg-white"
      (click)="onReload()"
      [disabled]="isLoading()"
      aria-label="Reload users"
    >
      <mat-icon>refresh</mat-icon>
    </button>
  </header>

  @if (isLoading()) {
    <div class="flex justify-center py-12">
      <mat-spinner diameter="40" />
    </div>
  } @else {
    @if (error()) {
      <p
        class="rounded-md border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-800"
        role="alert"
      >
        {{ error() }}
      </p>
    }

    @if (!users() || users()!.length === 0) {
      <p class="text-sm text-slate-600">No users found.</p>
    } @else {
      <mat-card class="overflow-x-auto">
        <table mat-table [dataSource]="users()!" class="min-w-full">
          <ng-container matColumnDef="username">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="text-left text-xs font-semibold uppercase tracking-wide text-slate-500"
            >
              Username
            </th>
            <td mat-cell *matCellDef="let user" class="text-sm text-slate-800">
              {{ user.username }}
            </td>
          </ng-container>

          <ng-container matColumnDef="fullname">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="text-left text-xs font-semibold uppercase tracking-wide text-slate-500"
            >
              Full name
            </th>
            <td mat-cell *matCellDef="let user" class="text-sm text-slate-800">
              {{ user.fullname }}
            </td>
          </ng-container>

          <ng-container matColumnDef="roles">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="text-left text-xs font-semibold uppercase tracking-wide text-slate-500"
            >
              Roles
            </th>
            <td mat-cell *matCellDef="let user" class="text-sm text-slate-800">
              {{ user.roles.join(', ') }}
            </td>
          </ng-container>

          <ng-container matColumnDef="actions">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="text-right text-xs font-semibold uppercase tracking-wide text-slate-500"
            >
              Actions
            </th>
            <td mat-cell *matCellDef="let user" class="text-right">
              <button
                mat-icon-button
                color="warn"
                type="button"
                (click)="onDelete(user.id)"
                aria-label="Delete user"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
      </mat-card>
    }
  }
</section>
