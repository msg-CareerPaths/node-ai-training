<section class="space-y-6">
  <header class="flex items-center justify-between gap-4">
    <h1 class="text-2xl font-semibold text-slate-900">
      {{ isAdmin() ? 'All orders' : 'My orders' }}
    </h1>

    <button
      mat-icon-button
      type="button"
      class="border border-slate-200 bg-white"
      (click)="onReload()"
      aria-label="Reload orders"
    >
      <mat-icon>refresh</mat-icon>
    </button>
  </header>

  @if (isLoading()) {
    <div class="flex justify-center py-12">
      <mat-spinner diameter="40" />
    </div>
  } @else {
    @if (error()) {
      <p
        class="rounded-md border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-800"
        role="alert"
      >
        {{ error() }}
      </p>
    }

    @if (!orders() || orders()!.length === 0) {
      <p class="text-sm text-slate-600">
        {{ isAdmin() ? 'No orders found.' : 'You have no orders yet.' }}
      </p>
    } @else {
      <mat-card class="overflow-x-auto">
        <table mat-table [dataSource]="orders()!" class="min-w-full">
          <ng-container matColumnDef="id">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="text-left text-xs font-semibold uppercase tracking-wide text-slate-500"
            >
              Order ID
            </th>
            <td mat-cell *matCellDef="let order" class="text-xs text-slate-800">
              {{ order.id }}
            </td>
          </ng-container>

          <ng-container matColumnDef="createdAt">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="text-left text-xs font-semibold uppercase tracking-wide text-slate-500"
            >
              Created at
            </th>
            <td mat-cell *matCellDef="let order" class="text-sm text-slate-800">
              {{ order.createdAt | date: 'short' }}
            </td>
          </ng-container>

          <ng-container matColumnDef="totalPrice">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="text-left text-xs font-semibold uppercase tracking-wide text-slate-500"
            >
              Total
            </th>
            <td mat-cell *matCellDef="let order" class="text-sm font-semibold text-slate-800">
              {{ order.totalPrice | currency }}
            </td>
          </ng-container>

          <ng-container matColumnDef="status">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="text-left text-xs font-semibold uppercase tracking-wide text-slate-500"
            >
              Status
            </th>
            <td mat-cell *matCellDef="let order" class="text-sm text-slate-800">
              {{ order.status }}
            </td>
          </ng-container>

          <ng-container matColumnDef="actions">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="text-right text-xs font-semibold uppercase tracking-wide text-slate-500"
            >
              Actions
            </th>
            <td mat-cell *matCellDef="let order" class="text-right">
              <button
                mat-button
                type="button"
                color="primary"
                [routerLink]="getDetailsLink(order.id)"
              >
                View
              </button>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
      </mat-card>
    }
  }
</section>
